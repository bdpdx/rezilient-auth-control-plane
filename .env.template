PORT=3010
AUTH_ISSUER=rezilient-auth-control-plane
AUTH_SIGNING_KEY=
TOKEN_TTL_SECONDS=300
TOKEN_CLOCK_SKEW_SECONDS=30
OUTAGE_GRACE_WINDOW_SECONDS=120
ENROLLMENT_CODE_TTL_SECONDS=900
ROTATION_OVERLAP_SECONDS=86400
AUTH_MAX_JSON_BODY_BYTES=1048576

# Required Postgres DSN for durable ACP registry/enrollment/audit state.
# Run bootstrap first: AUTH_PERSISTENCE_PG_URL=... npm run migrate:persistence
AUTH_PERSISTENCE_PG_URL=

# Optional state snapshot key; default is "default".
AUTH_PERSISTENCE_SNAPSHOT_KEY=default

# When true, /v1/admin/* endpoints are enabled and AUTH_ADMIN_TOKEN is required.
AUTH_ENABLE_ADMIN_ENDPOINTS=true

# Required when AUTH_ENABLE_ADMIN_ENDPOINTS=true.
# Callers must send x-rezilient-admin-token with this value.
AUTH_ADMIN_TOKEN=

# When true, /v1/internal/* endpoints are enabled and AUTH_INTERNAL_TOKEN is
# required for service-to-service auth.
AUTH_ENABLE_INTERNAL_ENDPOINTS=true

# Required when AUTH_ENABLE_INTERNAL_ENDPOINTS=true.
# Callers must send x-rezilient-internal-token or Authorization: Bearer <token>.
AUTH_INTERNAL_TOKEN=
